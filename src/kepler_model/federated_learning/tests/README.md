TODO: add tests for FL here